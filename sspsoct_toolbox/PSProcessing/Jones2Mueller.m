function M = Jones2Mueller(J)

    dimm = size(J);
    J = reshape(J,4,[]);

    dimm(1) = 16;
    M = zeros(dimm);


    M(1,:) = conj(J(1,:)).*J(1,:)+conj(J(3,:)).*J(3,:)+conj(J(2,:)).*J(2,:)+conj(J(4,:)).*J(4,:);
    M(5,:) = conj(J(1,:)).*J(1,:)+conj(J(2,:)).*J(2,:)-conj(J(3,:)).*J(3,:)-conj(J(4,:)).*J(4,:);
    M(9,:) = conj(J(1,:)).*J(3,:)+conj(J(2,:)).*J(4,:)+conj(J(3,:)).*J(1,:)+conj(J(4,:)).*J(2,:);
    M(13,:) = 1i.*(conj(J(1,:)).*J(3,:)+conj(J(2,:)).*J(4,:)-conj(J(3,:)).*J(1,:)-conj(J(4,:)).*J(2,:));
    M(2,:) = conj(J(1,:)).*J(1,:)+conj(J(3,:)).*J(3,:)-conj(J(2,:)).*J(2,:)-conj(J(4,:)).*J(4,:);
    M(6,:) = conj(J(1,:)).*J(1,:)+conj(J(4,:)).*J(4,:)-conj(J(2,:)).*J(2,:)-conj(J(3,:)).*J(3,:);
    M(10,:) = conj(J(3,:)).*J(1,:)+conj(J(1,:)).*J(3,:)-conj(J(4,:)).*J(2,:)-conj(J(2,:)).*J(4,:);
    M(14,:) = 1i.*(conj(J(1,:)).*J(3,:)+conj(J(4,:)).*J(2,:)-conj(J(2,:)).*J(4,:)-conj(J(3,:)).*J(1,:));
    M(3,:) = conj(J(1,:)).*J(2,:)+conj(J(2,:)).*J(1,:)+conj(J(3,:)).*J(4,:)+conj(J(4,:)).*J(3,:);
    M(7,:) = conj(J(1,:)).*J(2,:)+conj(J(2,:)).*J(1,:)-conj(J(3,:)).*J(4,:)-conj(J(4,:)).*J(3,:);
    M(11,:) = conj(J(1,:)).*J(4,:)+conj(J(2,:)).*J(3,:)+conj(J(3,:)).*J(2,:)+conj(J(4,:)).*J(1,:);
    M(15,:) = 1i.*(conj(J(1,:)).*J(4,:)+conj(J(2,:)).*J(3,:)-conj(J(3,:)).*J(2,:)-conj(J(4,:)).*J(1,:));
    M(4,:) = 1i.*(conj(J(2,:)).*J(1,:)+conj(J(4,:)).*J(3,:)-conj(J(1,:)).*J(2,:)-conj(J(3,:)).*J(4,:));
    M(8,:) = 1i.*(conj(J(2,:)).*J(1,:)+conj(J(3,:)).*J(4,:)-conj(J(1,:)).*J(2,:)-conj(J(4,:)).*J(3,:));
    M(12,:) = 1i.*(conj(J(2,:)).*J(3,:)+conj(J(4,:)).*J(1,:)-conj(J(1,:)).*J(4,:)-conj(J(3,:)).*J(2,:));   
    M(16,:) = conj(J(4,:)).*J(1,:)+conj(J(1,:)).*J(4,:)-conj(J(3,:)).*J(2,:)-conj(J(2,:)).*J(3,:);
    M = real(M./2);
    M = reshape(M,dimm);

end